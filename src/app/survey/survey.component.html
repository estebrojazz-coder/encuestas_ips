<div class="survey-container">
  <div class="background-overlay"></div>

  <mat-card class="survey-card">
    <!-- Logo -->
    <div class="header-container">
      <img src="assets/logo.png" alt="Logo" class="logo" />
      <mat-card-title>Encuesta de Satisfacci√≥n</mat-card-title>
      <mat-card-subtitle>Tu opini√≥n nos ayuda a mejorar</mat-card-subtitle>
    </div>

    <mat-card-content>
      <form [formGroup]="form" (ngSubmit)="onSubmit()">

        <!-- Selecci√≥n de rol -->
        <div class="rol-section">
          <mat-button-toggle-group formControlName="tipo" class="rol-toggle" appearance="legacy">
            <mat-button-toggle value="paciente">
              <mat-icon>person</mat-icon>
              Paciente
            </mat-button-toggle>

            <mat-button-toggle value="acompanante">
              <mat-icon>groups</mat-icon>
              Acompa√±ante
            </mat-button-toggle>
          </mat-button-toggle-group>
        </div>



        <!-- üìå Campos Paciente -->
        <div *ngIf="esPaciente()" class="form-section">
          <div class="documento-container">
            <mat-form-field appearance="outline">
              <mat-label>Tipo de documento</mat-label>
              <mat-select formControlName="tipoDocumento" required>
                <mat-option value="cc">C√©dula</mat-option>
                <mat-option value="ti">Tarjeta de Identidad</mat-option>
                <mat-option value="rc">Registro Civil</mat-option>
                <mat-option value="ce">C√©dula de Extranjer√≠a</mat-option>
                <mat-option value="pas">Pasaporte</mat-option>
                <mat-option value="ptp">Permiso Temporal</mat-option>
              </mat-select>
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>N√∫mero de documento</mat-label>
              <input matInput formControlName="cedula" required />
            </mat-form-field>
          </div>

          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Nombres y apellidos</mat-label>
            <input matInput formControlName="nombre" required />
          </mat-form-field>
        </div>

        <!-- üìå Campos Acompa√±ante -->
        <div *ngIf="esAcompanante()" class="form-section">
          <!-- Nombre acompa√±ante -->
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Nombre del acompa√±ante</mat-label>
            <input matInput formControlName="nombreAcompanante" required />
          </mat-form-field>

          <!-- Tipo y n√∫mero de documento paciente -->
          <div class="documento-container">
            <mat-form-field appearance="outline">
              <mat-label>Tipo de documento del paciente</mat-label>
              <mat-select formControlName="tipoDocumentoPaciente" required>
                <mat-option value="cc">C√©dula</mat-option>
                <mat-option value="ti">Tarjeta de Identidad</mat-option>
                <mat-option value="rc">Registro Civil</mat-option>
                <mat-option value="ce">C√©dula de Extranjer√≠a</mat-option>
                <mat-option value="pas">Pasaporte</mat-option>
                <mat-option value="ptp">Permiso Temporal</mat-option>
              </mat-select>
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>N√∫mero de documento</mat-label>
              <input matInput formControlName="pacienteCedula" required />
            </mat-form-field>
          </div>

          <!-- Nombre paciente -->
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Nombre del paciente</mat-label>
            <input matInput formControlName="pacienteNombre" required />
          </mat-form-field>
        </div>

        <!-- üìû Tel√©fono (paciente) -->
        <div *ngIf="esPaciente() || esAcompanante()" class="form-section">
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Tel√©fono</mat-label>
            <input matInput formControlName="telefono" required>
            <mat-error *ngIf="form.get('telefono')?.hasError('required')">
              El tel√©fono es obligatorio
            </mat-error>
            <mat-error *ngIf="form.get('telefono')?.hasError('pattern')">
              Solo se permiten n√∫meros (7 a 15 d√≠gitos)
            </mat-error>
          </mat-form-field>
        </div>

        <!-- üìå Calificaci√≥n -->
        <p class="section-title">Calificaci√≥n del servicio</p>
        <div class="stars">
          <span *ngFor="let star of stars; let i = index" class="star"
            [class.selected]="i < form.get('calificacion')?.value" (click)="setRating(i + 1)">
            ‚òÖ
          </span>
        </div>

        <p class="calificacion-valor">
          ‚≠ê Tu calificaci√≥n:
          <span class="calificacion-numero">
            {{ form.get('calificacion')?.value || 0 }}/5
          </span>
        </p>

        <!-- üìå Comentario -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Comentario</mat-label>
          <textarea matInput formControlName="comentario" rows="3"></textarea>
        </mat-form-field>

        <!-- üìå Bot√≥n -->
        <div class="button-container">
          <button mat-raised-button color="primary" type="submit" [disabled]="form.invalid">
            Enviar Encuesta
          </button>
        </div>
      </form>
    </mat-card-content>
  </mat-card>
</div>